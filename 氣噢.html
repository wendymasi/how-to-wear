<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—…éŠç©¿æ­å°å¹«æ‰‹</title>
    <style>
        :root {
            --primary-color: #f4a261;
            --bg-color: #fdfcf8;
            --card-bg: #ffffff;
            --text-color: #333;
        }

        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            background-color: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            width: 100%;
            max-width: 400px;
            padding: 30px;
            text-align: center;
        }

        h1 {
            color: var(--text-color);
            margin-bottom: 5px;
            font-size: 1.5rem;
        }

        .subtitle {
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 15px;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 0.9rem;
            color: #555;
        }

        /* ä¿®æ”¹ï¼šç¾åŒ–ä¸‹æ‹‰é¸å–® */
        select, input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            box-sizing: border-box;
            background-color: #f9f9f9;
            appearance: none; /* è®“ä¸åŒç€è¦½å™¨çš„ç®­é ­æ¨£å¼çµ±ä¸€ */
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='gray' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1em;
        }
        
        input[type="date"] {
            background-image: none; /* æ—¥æœŸé¸å–®ä¸éœ€è¦è‡ªè¨‚ç®­é ­ */
        }

        button {
            width: 100%;
            padding: 15px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
            margin-top: 10px;
        }

        button:hover {
            background-color: #e76f51;
        }

        #result {
            margin-top: 25px;
            text-align: left;
            display: none;
            animation: fadeIn 0.5s;
        }

        .weather-card {
            background-color: #fff8f0;
            border: 2px solid #ffe8cc;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .temp-display {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
            margin: 10px 0;
            text-align: center;
        }

        .temp-range {
            text-align: center;
            color: #666;
            font-size: 0.9rem;
        }

        .advice-card {
            background-color: white;
            border-radius: 15px;
            padding: 10px 0;
        }

        .advice-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .advice-icon {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loading {
            color: #888;
            margin-top: 20px;
            display: none;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ç©¿æ­å°å¹«æ‰‹ ğŸŒ¤ï¸</h1>
    <p class="subtitle">é¸æ“‡åŸå¸‚èˆ‡æ—¥æœŸï¼Œè‡ªå‹•æ¨è–¦ç©¿æ­</p>

    <div class="form-group">
        <label for="city">é¸æ“‡åŸå¸‚</label>
        <select id="city">
            <option value="Seoul">ğŸ‡°ğŸ‡· é¦–çˆ¾ (Seoul)</option>
            <option value="Busan">ğŸ‡°ğŸ‡· é‡œå±± (Busan)</option>
            <option value="Jeju City">ğŸ‡°ğŸ‡· æ¿Ÿå·å³¶ (Jeju)</option>
            <option value="Gangwon-do">ğŸ‡°ğŸ‡· æ±ŸåŸé“ (Gangwon-do)</option>
            <hr>
            <option value="Tokyo">ğŸ‡¯ğŸ‡µ æ±äº¬ (Tokyo)</option>
            <option value="Osaka">ğŸ‡¯ğŸ‡µ å¤§é˜ª (Osaka)</option>
            <option value="Fukuoka">ğŸ‡¯ğŸ‡µ ç¦å²¡ (Fukuoka)</option>
            <hr>
            <option value="Da Nang">ğŸ‡»ğŸ‡³ å³´æ¸¯ (Da Nang)</option>
            <option value="Ho Chi Minh City">ğŸ‡»ğŸ‡³ èƒ¡å¿—æ˜å¸‚ (Ho Chi Minh)</option>
            <option value="Hanoi">ğŸ‡»ğŸ‡³ æ²³å…§ (Hanoi)</option>
            <hr>
            <option value="Bangkok">ğŸ‡¹ğŸ‡­ æ›¼è°· (Bangkok)</option>
            <option value="Chiang Mai">ğŸ‡¹ğŸ‡­ æ¸…é‚ (Chiang Mai)</option>
            <option value="Hua Hin">ğŸ‡¹ğŸ‡­ è¯æ¬£ (Hua Hin)</option>
        </select>
    </div>

    <div class="form-group">
        <label for="date">æ—¥æœŸ</label>
        <input type="date" id="date">
    </div>

    <button onclick="getWeather()">æŸ¥è©¢å¤©æ°£èˆ‡ç©¿æ­</button>
    <div id="loading" class="loading">æ­£åœ¨é€£ç·šæ°£è±¡è¡›æ˜Ÿ...ğŸ›°ï¸</div>

    <div id="result">
        <div class="weather-card">
            <div style="text-align: center; font-weight: bold; color: #555;">é æ¸¬æ°£æº«</div>
            <div class="temp-display" id="avg-temp">--Â°C</div>
            <div class="temp-range">æœ€ä½ <span id="min-temp">--</span>Â° / æœ€é«˜ <span id="max-temp">--</span>Â°</div>
        </div>

        <div class="advice-card">
            <h3 style="font-size: 1.1rem; margin-bottom: 15px;">ğŸ‘• å»ºè­°ç©¿æ­ï¼š</h3>
            <div id="advice-list">
                </div>
        </div>
    </div>
</div>

<script>
    // è¨­å®šé è¨­æ—¥æœŸç‚ºä»Šå¤©
    document.getElementById('date').valueAsDate = new Date();

    async function getWeather() {
        const cityValue = document.getElementById('city').value; // é€™è£¡æœƒæŠ“åˆ° value è£¡çš„è‹±æ–‡
        const dateInput = document.getElementById('date').value;
        const resultDiv = document.getElementById('result');
        const loadingDiv = document.getElementById('loading');
        
        // é¡¯ç¤ºè¼‰å…¥ä¸­
        resultDiv.style.display = 'none';
        loadingDiv.style.display = 'block';

        try {
            // 1. æœå°‹åŸå¸‚ç¶“ç·¯åº¦ (å› ç‚ºä½¿ç”¨é¸å–®çš„ç²¾æº–è‹±æ–‡ï¼Œæ‰€ä»¥å¹¾ä¹ä¸æœƒå¤±æ•—)
            const geoRes = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${cityValue}&count=1&language=en&format=json`);
            const geoData = await geoRes.json();

            if (!geoData.results) {
                alert("æ‰¾ä¸åˆ°é€™å€‹åŸå¸‚çš„è³‡æ–™ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚");
                loadingDiv.style.display = 'none';
                return;
            }

            const { latitude, longitude } = geoData.results[0];

            // 2. æŸ¥è©¢å¤©æ°£
            const weatherRes = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&daily=temperature_2m_max,temperature_2m_min&timezone=auto&start_date=${dateInput}&end_date=${dateInput}`);
            const weatherData = await weatherRes.json();

            if (!weatherData.daily) {
                alert("ç„¡æ³•å–å¾—è©²æ—¥æœŸçš„å¤©æ°£è³‡è¨Šï¼Œè«‹æŸ¥è©¢æœªä¾† 7 å¤©å…§çš„æ—¥æœŸã€‚");
                loadingDiv.style.display = 'none';
                return;
            }

            const minTemp = weatherData.daily.temperature_2m_min[0];
            const maxTemp = weatherData.daily.temperature_2m_max[0];
            const avgTemp = (minTemp + maxTemp) / 2;

            // 3. é¡¯ç¤ºæ•¸æ“š
            document.getElementById('min-temp').innerText = minTemp;
            document.getElementById('max-temp').innerText = maxTemp;
            document.getElementById('avg-temp').innerText = avgTemp.toFixed(1) + "Â°C";

            // 4. ç”¢ç”Ÿç©¿æ­å»ºè­°
            generateOutfitAdvice(avgTemp, minTemp);

            loadingDiv.style.display = 'none';
            resultDiv.style.display = 'block';

        } catch (error) {
            console.error(error);
            alert("ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚");
            loadingDiv.style.display = 'none';
        }
    }

    function generateOutfitAdvice(avgTemp, minTemp) {
        let advices = [];

        if (avgTemp >= 30) {
            advices = ["ğŸ¥µ å¤©æ°£è¶…ç´šç†±ï¼é€æ°£æœ€é‡è¦", "æ¨è–¦ï¼šçŸ­è¢–ã€çŸ­è¤²ã€èƒŒå¿ƒã€æ¶¼é‹", "å¿…å‚™ï¼šé˜²æ›¬ä¹³ã€å¢¨é¡ã€å°é¢¨æ‰‡"];
        } else if (avgTemp >= 25) {
            advices = ["ğŸ˜ æº«æš–èˆ’é©ï¼Œé©åˆè¼•ä¾¿ç©¿æ­", "æ¨è–¦ï¼šçŸ­è¢–ã€è–„è¥¯è¡«ã€æ£‰éº»é•·è¤²", "æé†’ï¼šå®¤å…§å†·æ°£å¼·ï¼Œå¯å¸¶è–„å¤–å¥—"];
        } else if (avgTemp >= 20) {
            advices = ["ğŸ‚ å¾®æ¶¼èˆ’æœï¼Œæœ€é©åˆæ—…éŠçš„æº«åº¦", "æ¨è–¦ï¼šè–„é•·è¢–ã€é‡ç¹”è¡«ã€ç‰›ä»”è¤²", "æé†’ï¼šå»ºè­°å¸¶ä»¶é¢¨è¡£æˆ–ç‰›ä»”å¤–å¥—"];
        } else if (avgTemp >= 15) {
            advices = ["ğŸ§¥ æœ‰é»å†·å›‰ï¼Œè¦æ³¨æ„ä¿æš–", "æ¨è–¦ï¼šå¤§å­¸ Tã€å¸½ Tã€åšå¤¾å…‹", "æé†’ï¼šæ€•å†·çš„å¯ä»¥åœ¨è£¡é¢åŠ ç™¼ç†±è¡£"];
        } else if (avgTemp >= 10) {
            advices = ["ğŸ§£ è »å†·çš„ï¼åšå¤–å¥—è¦å‡ºå‹•äº†", "æ¨è–¦ï¼šæ¯›è¡£ã€æ¯›å‘¢å¤§è¡£ã€åšé•·è¤²", "å¿…å‚™ï¼šåœå·¾æ˜¯æœ€å¥½çš„æ™‚å°šä¿æš–å–®å“"];
        } else if (avgTemp >= 5) {
            advices = ["ğŸ§¤ å¯’æµç­‰ç´šï¼å…¨èº«éƒ½è¦åŒ…èµ·ä¾†", "æ¨è–¦ï¼šç¾½çµ¨å¤–å¥—ã€ç¾Šæ¯›è¡£ã€ç™¼ç†±è¤²", "å¿…å‚™ï¼šæ‰‹å¥—ã€æ¯›å¸½ã€æš–æš–åŒ…"];
        } else {
            advices = ["ğŸ¥¶ å‡åƒµäº†ï¼ç”Ÿå­˜ä¿æš–ç¬¬ä¸€", "æ¨è–¦ï¼šé•·ç‰ˆç¾½çµ¨è¡£ã€é˜²é¢¨è¤²ã€åˆ·æ¯›å…§æ­", "æé†’ï¼šæ²’äº‹åˆ¥è®“çš®è†šéœ²åœ¨å¤–é¢ï¼"];
        }

        if (minTemp < 10 && avgTemp > 18) {
            advices.push("âš ï¸ æ—¥å¤œæº«å·®éå¸¸å¤§ï¼Œä¸€å®šè¦æ´‹è”¥å¼ç©¿æ­ï¼");
        }

        const list = document.getElementById('advice-list');
        list.innerHTML = advices.map(item => `<div class="advice-item"><span class="advice-icon">ğŸ‘‰</span>${item}</div>`).join('');
    }
</script>

</body>
</html>